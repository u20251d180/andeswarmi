<!-- HEADER NAVBAR -->
<header class="aw-navbar">
  <!-- Bot√≥n hamburguesa -->
  <button class="icon-btn menu-btn" (click)="toggleSidebar()" aria-label="Open menu">
    <img class="icon" src="assets/icons/icon_menu.svg" alt="menu" />
  </button>

  <!-- Logo -->
  <a routerLink="/" class="brand" aria-label="Home">
    <img class="aw-logo" src="assets/logos/andeswarmi-logo.svg" alt="AndesWarmi" />
  </a>

  <!-- Categor√≠as Desktop -->
  <nav class="nav-cats">
    <button
      *ngFor="let cat of categories"
      (click)="selectCategory(cat)"
      [class.active]="cat === activeCategory"
      class="chip"
    >
      {{ cat }}
    </button>
  </nav>

  <!-- Acciones -->
  <div class="actions">
    <!-- Visitante -->
    <a *ngIf="!user" routerLink="/login" class="signin">Iniciar sesi√≥n</a>

    <!-- Usuario logueado -->
    <ng-container *ngIf="user">
      <div class="user-menu" (click)="toggleUserMenu()" [class.open]="userMenuOpen">
        <span class="user-email">{{ user.email }}</span>
        <i class="fa-solid fa-chevron-down"></i>

        <!-- Dropdown -->
        <div class="user-dropdown" *ngIf="userMenuOpen">
          <a routerLink="/account" class="dropdown-item">Mi cuenta</a>
          <a routerLink="/orders" class="dropdown-item">Mis pedidos</a>
          <button (click)="logout()" class="dropdown-item">Salir</button>
        </div>
      </div>
    </ng-container>

    <!-- Carrito -->
    <button class="icon-btn cart-button" aria-label="Cart" (click)="openCart()">
      <img class="icon" src="assets/icons/icon_shopping_cart.svg" alt="cart" />
      <span class="cart-badge" *ngIf="cartCount > 0">{{ cartCount }}</span>
    </button>
  </div>
</header>

<!-- SIDEBAR (mobile) -->

<aside class="sidebar" [class.open]="sidebarOpen">
  <div class="sidebar-header">
    <h3>Categor√≠as</h3>
    <button class="close-btn" (click)="toggleSidebar()">‚úï</button>
  </div>

  <nav class="sidebar-menu">
    <a
      *ngFor="let category of categories"
      class="sidebar-link"
      [class.active]="category === activeCategory"
      (click)="selectCategory(category); toggleSidebar()"
    >
      {{ category }}
    </a>

    <hr />

    <a *ngIf="!user" routerLink="/login" class="sidebar-link" (click)="toggleSidebar()"
      >Iniciar Sesi√≥n</a
    >

    <ng-container *ngIf="user">
      <a routerLink="/orders" class="sidebar-link" (click)="toggleSidebar()">Mis pedidos</a>
      <div class="sidebar-backdrop" *ngIf="sidebarOpen" (click)="toggleSidebar()"></div>
      <a routerLink="/account" class="menu-item" (click)="toggleSidebar()">Mi cuenta</a>
      <!-- üîπ Mostrar correo del usuario -->
      <div *ngIf="user" class="sidebar-user">
        <p
          class="user-email"
          style="
            color: #523b2b;
            font-weight: lighter;
            font-size: 14px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            margin-bottom: 1em;
            margin-top: 1.5em;
          "
        >
          {{ user.email }}
        </p>

        <button
          class="sidebar-link"
          style="background: none; border: 0; padding: 0; text-align: left; font-size: 16px"
          (click)="logout()"
        >
          Salir
        </button>
      </div>
    </ng-container>
  </nav>
</aside>
